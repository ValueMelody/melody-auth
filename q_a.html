<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.21" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Common Questions | Melody Auth</title><meta name="description" content="Effortless OAuth and Authentication, Built for Flexibility and Control.">
    <link rel="preload" href="/assets/style-5UBalbIg.css" as="style"><link rel="stylesheet" href="/assets/style-5UBalbIg.css">
    <link rel="modulepreload" href="/assets/app-CcTSijay.js"><link rel="modulepreload" href="/assets/q_a.html-QdQMvQXZ.js">
    <link rel="prefetch" href="/assets/index.html-DS4aaHZW.js" as="script"><link rel="prefetch" href="/assets/admin-panel-setup.html-tLvI2WdW.js" as="script"><link rel="prefetch" href="/assets/angular-sdk.html-DbXhDr5d.js" as="script"><link rel="prefetch" href="/assets/app-banners.html-BsD8yd3Z.js" as="script"><link rel="prefetch" href="/assets/auth-server-configuration.html-DTDRbJxw.js" as="script"><link rel="prefetch" href="/assets/auth-server-setup.html-CyMceXjh.js" as="script"><link rel="prefetch" href="/assets/deployment-pipelines.html-B5SAr7w1.js" as="script"><link rel="prefetch" href="/assets/email-provider-setup.html-C0NwTQ6_.js" as="script"><link rel="prefetch" href="/assets/embedded-auth-api.html-C4pI2mv2.js" as="script"><link rel="prefetch" href="/assets/react-sdk.html-CsUyX6vV.js" as="script"><link rel="prefetch" href="/assets/s2s-api.html-DDekhKZz.js" as="script"><link rel="prefetch" href="/assets/saml-sso-setup.html-QQh68IjP.js" as="script"><link rel="prefetch" href="/assets/screenshots.html-CLU6XlBS.js" as="script"><link rel="prefetch" href="/assets/sms-provider-setup.html-BKpp08UT.js" as="script"><link rel="prefetch" href="/assets/social-sign-in-provider-setup.html-jST9mxt2.js" as="script"><link rel="prefetch" href="/assets/vue-sdk.html-BagnFC7M.js" as="script"><link rel="prefetch" href="/assets/web-sdk.html-CcYASEJN.js" as="script"><link rel="prefetch" href="/assets/index.html-62GAztUn.js" as="script"><link rel="prefetch" href="/assets/admin-panel-setup.html-Lh-AzfFe.js" as="script"><link rel="prefetch" href="/assets/angular-sdk.html-DWMePYQr.js" as="script"><link rel="prefetch" href="/assets/app-banners.html-CuLXAFQS.js" as="script"><link rel="prefetch" href="/assets/auth-server-configuration.html-CH51U7Tz.js" as="script"><link rel="prefetch" href="/assets/auth-server-setup.html-DuqrOhQv.js" as="script"><link rel="prefetch" href="/assets/deployment-pipelines.html-CfOyywF5.js" as="script"><link rel="prefetch" href="/assets/email-provider-setup.html-Bsf3jUxC.js" as="script"><link rel="prefetch" href="/assets/embedded-auth-api.html-OpcWUYrq.js" as="script"><link rel="prefetch" href="/assets/q_a.html-BlgtkpLf.js" as="script"><link rel="prefetch" href="/assets/react-sdk.html-C4DhaMH5.js" as="script"><link rel="prefetch" href="/assets/s2s-api.html-CvKvB6IA.js" as="script"><link rel="prefetch" href="/assets/saml-sso-setup.html-DAc5c5TF.js" as="script"><link rel="prefetch" href="/assets/screenshots.html-17-HhVDB.js" as="script"><link rel="prefetch" href="/assets/sms-provider-setup.html-ChU2HsMl.js" as="script"><link rel="prefetch" href="/assets/social-sign-in-provider-setup.html-DLtJtYiN.js" as="script"><link rel="prefetch" href="/assets/vue-sdk.html-TGtkSbyH.js" as="script"><link rel="prefetch" href="/assets/web-sdk.html-DeHHNr3k.js" as="script"><link rel="prefetch" href="/assets/404.html-OJvh_GRE.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://valuemelody.com/logo.svg" alt="Melody Auth"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Melody Auth</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Get Started"><span class="title">Get Started</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Get Started"><span class="title">Get Started</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/auth-server-setup.html" aria-label="Auth Server Setup"><!--[--><!--[--><!--]--><!--]-->Auth Server Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/auth-server-configuration.html" aria-label="Auth Server Configuration"><!--[--><!--[--><!--]--><!--]-->Auth Server Configuration<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/admin-panel-setup.html" aria-label="Admin Panel Setup"><!--[--><!--[--><!--]--><!--]-->Admin Panel Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/email-provider-setup.html" aria-label="Email Provider Setup"><!--[--><!--[--><!--]--><!--]-->Email Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/sms-provider-setup.html" aria-label="SMS Provider Setup"><!--[--><!--[--><!--]--><!--]-->SMS Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Identity Providers"><span class="title">Identity Providers</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Identity Providers"><span class="title">Identity Providers</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/social-sign-in-provider-setup.html" aria-label="Social Sign-In Provider Setup"><!--[--><!--[--><!--]--><!--]-->Social Sign-In Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/saml-sso-setup.html" aria-label="SAML SSO Setup"><!--[--><!--[--><!--]--><!--]-->SAML SSO Setup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Additional Features"><span class="title">Additional Features</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Additional Features"><span class="title">Additional Features</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/app-banners.html" aria-label="App Banners"><!--[--><!--[--><!--]--><!--]-->App Banners<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Frontend SDKs"><span class="title">Frontend SDKs</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Frontend SDKs"><span class="title">Frontend SDKs</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/react-sdk.html" aria-label="React SDK"><!--[--><!--[--><!--]--><!--]-->React SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/angular-sdk.html" aria-label="Angular SDK"><!--[--><!--[--><!--]--><!--]-->Angular SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vue-sdk.html" aria-label="Vue SDK"><!--[--><!--[--><!--]--><!--]-->Vue SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/web-sdk.html" aria-label="Web SDK"><!--[--><!--[--><!--]--><!--]-->Web SDK<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Backend APIs"><span class="title">Backend APIs</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Backend APIs"><span class="title">Backend APIs</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/s2s-api.html" aria-label="S2S API"><!--[--><!--[--><!--]--><!--]-->S2S API<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="auto-link external-link" href="https://auth-server.valuemelody.com/api/v1/swagger" aria-label="S2S API Swagger" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->S2S API Swagger<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/embedded-auth-api.html" aria-label="Embedded Auth API"><!--[--><!--[--><!--]--><!--]-->Embedded Auth API<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="auto-link external-link" href="https://auth-server.valuemelody.com/api/v1/embedded-swagger" aria-label="Embedded Auth API Swagger" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Embedded Auth API Swagger<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/q_a.html" aria-label="English"><!--[--><!--[--><!--]--><!--]-->English<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/zh/q_a.html" aria-label="zh-CN"><!--[--><!--[--><!--]--><!--]-->zh-CN<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Get Started"><span class="title">Get Started</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Get Started"><span class="title">Get Started</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/auth-server-setup.html" aria-label="Auth Server Setup"><!--[--><!--[--><!--]--><!--]-->Auth Server Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/auth-server-configuration.html" aria-label="Auth Server Configuration"><!--[--><!--[--><!--]--><!--]-->Auth Server Configuration<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/admin-panel-setup.html" aria-label="Admin Panel Setup"><!--[--><!--[--><!--]--><!--]-->Admin Panel Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/email-provider-setup.html" aria-label="Email Provider Setup"><!--[--><!--[--><!--]--><!--]-->Email Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/sms-provider-setup.html" aria-label="SMS Provider Setup"><!--[--><!--[--><!--]--><!--]-->SMS Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Identity Providers"><span class="title">Identity Providers</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Identity Providers"><span class="title">Identity Providers</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/social-sign-in-provider-setup.html" aria-label="Social Sign-In Provider Setup"><!--[--><!--[--><!--]--><!--]-->Social Sign-In Provider Setup<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/saml-sso-setup.html" aria-label="SAML SSO Setup"><!--[--><!--[--><!--]--><!--]-->SAML SSO Setup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Additional Features"><span class="title">Additional Features</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Additional Features"><span class="title">Additional Features</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/app-banners.html" aria-label="App Banners"><!--[--><!--[--><!--]--><!--]-->App Banners<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Frontend SDKs"><span class="title">Frontend SDKs</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Frontend SDKs"><span class="title">Frontend SDKs</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/react-sdk.html" aria-label="React SDK"><!--[--><!--[--><!--]--><!--]-->React SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/angular-sdk.html" aria-label="Angular SDK"><!--[--><!--[--><!--]--><!--]-->Angular SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vue-sdk.html" aria-label="Vue SDK"><!--[--><!--[--><!--]--><!--]-->Vue SDK<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/web-sdk.html" aria-label="Web SDK"><!--[--><!--[--><!--]--><!--]-->Web SDK<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Backend APIs"><span class="title">Backend APIs</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Backend APIs"><span class="title">Backend APIs</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/s2s-api.html" aria-label="S2S API"><!--[--><!--[--><!--]--><!--]-->S2S API<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="auto-link external-link" href="https://auth-server.valuemelody.com/api/v1/swagger" aria-label="S2S API Swagger" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->S2S API Swagger<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/embedded-auth-api.html" aria-label="Embedded Auth API"><!--[--><!--[--><!--]--><!--]-->Embedded Auth API<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="auto-link external-link" href="https://auth-server.valuemelody.com/api/v1/embedded-swagger" aria-label="Embedded Auth API Swagger" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Embedded Auth API Swagger<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/q_a.html" aria-label="English"><!--[--><!--[--><!--]--><!--]-->English<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/zh/q_a.html" aria-label="zh-CN"><!--[--><!--[--><!--]--><!--]-->zh-CN<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Common Questions <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="common-questions" tabindex="-1"><a class="header-anchor" href="#common-questions"><span>Common Questions</span></a></h1><h2 id="how-to-verify-a-spa-access-token" tabindex="-1"><a class="header-anchor" href="#how-to-verify-a-spa-access-token"><span>How to verify a SPA access token</span></a></h2><p>When verifying a SPA access token that uses the RSA256 algorithm, you can obtain the public key by fetching the JWKS (JSON Web Key Set) from [Your auth server URL]/.well-known/jwks.json. Below is a code example demonstrating how to verify the token using the jwks-rsa library:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">import { verify } from &#39;jsonwebtoken&#39;</span>
<span class="line">import jwksClient from &#39;jwks-rsa&#39; </span>
<span class="line"></span>
<span class="line">// Initialize JWKS client with the URL to fetch keys</span>
<span class="line">const client = jwksClient({ jwksUri: `${process.env.NEXT_PUBLIC_SERVER_URI}/.well-known/jwks.json` })</span>
<span class="line"></span>
<span class="line">// Function to retrieve the signing key from the JWKS endpoint</span>
<span class="line">const getKey = (</span>
<span class="line">  header, callback,</span>
<span class="line">) =&gt; {</span>
<span class="line">  return client.getSigningKey(</span>
<span class="line">    header.kid,</span>
<span class="line">    (</span>
<span class="line">      err, key,</span>
<span class="line">    ) =&gt; {</span>
<span class="line">      if (err) {</span>
<span class="line">        callback(err)</span>
<span class="line">      } else {</span>
<span class="line">        const signingKey = key.publicKey || key.rsaPublicKey</span>
<span class="line">        callback(</span>
<span class="line">          null,</span>
<span class="line">          signingKey,</span>
<span class="line">        )</span>
<span class="line">      }</span>
<span class="line">    },</span>
<span class="line">  )</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">// Function to verify the JWT token</span>
<span class="line">const verifyJwtToken = (token: string) =&gt; {</span>
<span class="line">  return new Promise((</span>
<span class="line">    resolve, reject,</span>
<span class="line">  ) =&gt; {</span>
<span class="line">    verify(</span>
<span class="line">      token,</span>
<span class="line">      getKey,</span>
<span class="line">      {},</span>
<span class="line">      (</span>
<span class="line">        err, decoded,</span>
<span class="line">      ) =&gt; {</span>
<span class="line">        if (err) {</span>
<span class="line">          reject(err)</span>
<span class="line">        } else {</span>
<span class="line">          resolve(decoded)</span>
<span class="line">        }</span>
<span class="line">      },</span>
<span class="line">    )</span>
<span class="line">  })</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">// Function to verify the access token from request headers</span>
<span class="line">export const verifyAccessToken = async () =&gt; {</span>
<span class="line">  const headersList = headers()</span>
<span class="line">  const authHeader = headersList.get(&#39;authorization&#39;)</span>
<span class="line">  const accessToken = authHeader?.split(&#39; &#39;)[1]</span>
<span class="line"></span>
<span class="line">  if (!accessToken) return false</span>
<span class="line"></span>
<span class="line">  const tokenBody = await verifyJwtToken(accessToken)</span>
<span class="line"></span>
<span class="line">  if (!tokenBody) return false</span>
<span class="line"></span>
<span class="line">  return true</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="how-to-support-a-new-locale" tabindex="-1"><a class="header-anchor" href="#how-to-support-a-new-locale"><span>How to support a new locale</span></a></h2><p>English (EN) and French (FR) are supported by default in this project. To add support for additional locales, follow these steps:</p><ul><li>Update the server/src/configs/locale.ts file, ensuring that translations for your new locale are provided.</li><li>Update the SUPPORTED_LOCALES environment variable to include your new locale in the array.</li></ul><h2 id="how-to-rotate-jwt-secret" tabindex="-1"><a class="header-anchor" href="#how-to-rotate-jwt-secret"><span>How to rotate JWT secret</span></a></h2><p>To rotate your JWT secret, follow these steps:</p><ol><li><p>Generate a New JWT Secret:<br> Run the secret generation script based on your environment.<br> After running these commands, a new pair of JWT secrets will take effect. Your old JWT secret will be marked as deprecated. This means the old secret will no longer be used to sign new tokens, but existing tokens signed with the old secret will still be verified.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd server</span>
<span class="line">npm run node:secret:generate # For node env</span>
<span class="line">npm run dev:secret:generate # For Cloudflare local env</span>
<span class="line">npm run prod:secret:generate # For Cloudflare remote env</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Clean the Old Secret:<br> Run the secret clean script whenever you want to stop verifying tokens signed with the old secret. After running these commands, the old secret will be removed, and any tokens signed with the old secret will no longer be valid.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd server</span>
<span class="line">npm run node:secret:clean # For node env</span>
<span class="line">npm run dev:secret:clean # For Cloudflare local env</span>
<span class="line">npm run prod:secret:clean # For Cloudflare remote env</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="how-to-setup-mfa" tabindex="-1"><a class="header-anchor" href="#how-to-setup-mfa"><span>How to setup MFA</span></a></h2><ul><li>Enforcing specific MFA types: You can set OTP_MFA_IS_REQUIRED, SMS_MFA_IS_REQUIRED, or EMAIL_MFA_IS_REQUIRED to true to enforce those MFA methods as a login requirement.</li><li>Letting users choose one of the supported MFA types: If OTP_MFA_IS_REQUIRED, SMS_MFA_IS_REQUIRED, and EMAIL_MFA_IS_REQUIRED are all set to false, you can set ENFORCE_ONE_MFA_ENROLLMENT to contain the MFA types you want to support. The user will then be required to enroll in one of the selected MFA types.</li><li>You can also use the MFA enrollment functionality provided by the admin panel or the S2S API to customize your MFA enrollment flow.</li></ul><h2 id="how-to-trigger-a-different-policy" tabindex="-1"><a class="header-anchor" href="#how-to-trigger-a-different-policy"><span>How to trigger a different policy</span></a></h2><ul><li>To trigger a different policy, add policy=[policy] as a query string when redirecting the user to the authorization page.<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">  const url = serverUri +</span>
<span class="line">    &#39;/oauth2/v1/authorize?&#39; +</span>
<span class="line">    &#39;response_type=code&#39; +</span>
<span class="line">    &#39;&amp;state=&#39; + state +</span>
<span class="line">    &#39;&amp;client_id=&#39; + clientId +</span>
<span class="line">    &#39;&amp;redirect_uri=&#39; + redirectUri +</span>
<span class="line">    &#39;&amp;code_challenge=&#39; + codeChallenge +</span>
<span class="line">    &#39;&amp;code_challenge_method=S256&#39; +</span>
<span class="line">    &#39;&amp;policy=&#39; + policy +</span>
<span class="line">    &#39;&amp;scope=&#39; + scope +</span>
<span class="line">    &#39;&amp;locale=&#39; + locale</span>
<span class="line">  window.location.href = url</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>When using the React SDK, you can trigger the loginRedirect function with a policy parameter:<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">const { loginRedirect } = useAuth()</span>
<span class="line"></span>
<span class="line">loginRedirect({</span>
<span class="line">  policy: &#39;change_password&#39;,</span>
<span class="line">})</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>Supported Policies <ul><li>sign_in_or_sign_up: Default policy.</li><li>update_info: Allows users to update their information.</li><li>change_password: Allows users to change their password (for password-based users only). Requires ENABLE_PASSWORD_RESET to be set to true in the configuration.</li><li>change_email: Allows users to change their email address (for password-based users only). Requires ENABLE_EMAIL_VERIFICATION to be set to true in the configuration.</li><li>reset_mfa: Allows users to reset their enrolled MFA (Multi-Factor Authentication) method.</li><li>manage_passkey: Allows users to manage their passkey. Requires ALLOW_PASSKEY_ENROLLMENT to be set to true in the configuration.</li></ul></li></ul><h2 id="how-to-trigger-oidc-sso-login-redirect-via-policy-in-frontend" tabindex="-1"><a class="header-anchor" href="#how-to-trigger-oidc-sso-login-redirect-via-policy-in-frontend"><span>How to trigger OIDC SSO login redirect via policy in frontend</span></a></h2><ul><li>In server/src/configs/variable.ts, set &quot;enableSignInRedirect&quot; of the OIDCProviderConfigs for the provider you want to use to true.</li><li>Use the loginRedirect function provided by your Melody Auth frontend SDK (e.g., @melody-auth/react) to initiate the login process:</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">  const {</span>
<span class="line">    loginRedirect</span>
<span class="line">  } = useAuth()</span>
<span class="line"></span>
<span class="line">  loginRedirect({</span>
<span class="line">    policy: &#39;oidc_sso_[provider_name]&#39; # Replace [provider_name] with the name of the provider you defined in server/src/configs/variable.ts</span>
<span class="line">  })</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="how-to-change-theme-branding-for-authorization-pages" tabindex="-1"><a class="header-anchor" href="#how-to-change-theme-branding-for-authorization-pages"><span>How to change theme/branding for authorization pages</span></a></h2><ul><li>You can change the default theme/branding by setting the <code>DefaultBranding</code> variable in server/src/configs/variable.ts.</li><li>In case you want to use different theme/branding for different clients <ul><li>set ENABLE_ORG to true in server/wrangler.toml</li><li>create a new org in the admin panel, with a unique slug</li><li>update the theme/branding for the org you just created in the admin panel</li><li>trigger a login redirect to the authorization page with the org=[slug] as query string</li></ul></li></ul><h2 id="how-to-allow-users-with-a-custom-role-to-perform-impersonation" tabindex="-1"><a class="header-anchor" href="#how-to-allow-users-with-a-custom-role-to-perform-impersonation"><span>How to allow users with a custom role to perform impersonation</span></a></h2><p>By default, only users with the super_admin role can impersonate other accounts. To let a custom-role user perform impersonation:</p><ul><li>Add the custom role to the impersonationRoles array in server/src/configs/variable.ts. This enables the role to impersonate on the S2S API side.</li><li>Add Access.Impersonation to the allowedAccesses array in admin-panel/tools/access.ts for that role. This grants impersonation permission in the Admin Panel.</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-06-28T00:51:12.000Z" data-allow-mismatch>6/28/25, 12:51 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: byn9826@gmail.com">Baozier</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CcTSijay.js" defer></script>
  </body>
</html>
