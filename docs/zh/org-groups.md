# 组织分组

组织分组允许管理员将组织内的用户组织成逻辑分组，以便更好地进行管理和访问控制。此功能为用户分类和集中管理提供了灵活的方式。

## 什么是组织分组？

组织分组是一个容器，可以容纳同一组织内的多个用户。它的作用包括：

- 将用户组织成逻辑单元（如部门、团队、项目）
- 通过将相关用户分组来简化用户管理
- 提供更清晰的组织结构可视化

## 启用组织分组

组织分组功能由 `server/src/configs/variable.ts` 文件中的 `systemConfig.enableOrgGroup` 变量控制。你还需要先在 `server/wrangler.toml` 文件中将 `ENABLE_ORG` 设置为 `true` 来启用组织功能。

## 核心功能

### 分组管理
- **创建分组**：管理员可以在组织内创建命名分组
- **编辑分组**：可以根据需要修改分组名称
- **删除分组**：不再需要的分组可以删除
- **列出分组**：查看组织内的所有分组

### 用户分配
- **将用户添加到分组**：可以将单个用户分配到一个或多个分组
- **从分组移除用户**：可以将用户从指定分组中移除
- **多分组成员**：用户可以同时属于多个分组
- **查看分组成员**：查看分配到特定分组的所有用户

#### 创建分组
分组是在组织上下文中创建的，并且在该组织内必须具有唯一名称。

#### 分配用户
可以在管理面板的用户详情页面将用户分配到分组。系统通过关联表维护这种关系，从而支持：
- 每个分组包含多个用户
- 每个用户属于多个分组  
![用户组织分组](https://raw.githubusercontent.com/ValueMelody/melody-auth/main/docs/images/user_org_groups.jpg)

#### 分组筛选
在管理面板中，管理员可以通过分组筛选用户列表，仅查看属于特定分组的用户。

## 管理面板使用方法

### 管理分组

1. **进入组织**：在管理面板中进入组织页面
2. **查看分组**：分组会在组织视图中以徽章形式显示
3. **创建新分组**：点击 “Create an org group” 按钮
4. **编辑分组**：点击分组徽章上的编辑图标
5. **删除分组**：点击分组徽章上的删除图标  
![组织分组管理](https://raw.githubusercontent.com/ValueMelody/melody-auth/main/docs/images/org_group_management.jpg)

## S2S API 集成

可以通过 S2S API 管理组织分组：
```http
GET /api/v1/org-groups: 获取所有组织分组
GET /api/v1/org-groups/{id}/users: 获取指定组织分组中的所有用户
POST /api/v1/org-groups: 创建新的组织分组
PUT /api/v1/org-groups/{id}: 更新已有的组织分组
DELETE /api/v1/org-groups/{id}: 删除组织分组
```
