<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.21" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Admin Panel | Melody Auth</title><meta name="description" content="Effortless OAuth and Authentication, Built for Flexibility and Control.">
    <link rel="preload" href="/assets/style-5UBalbIg.css" as="style"><link rel="stylesheet" href="/assets/style-5UBalbIg.css">
    <link rel="modulepreload" href="/assets/app-BVdeq8C2.js"><link rel="modulepreload" href="/assets/admin-panel-setup.html-CPy274u5.js">
    <link rel="prefetch" href="/assets/index.html-9z2FZg_b.js" as="script"><link rel="prefetch" href="/assets/angular-sdk.html-DgK-1FLY.js" as="script"><link rel="prefetch" href="/assets/auth-server-configuration.html-Yz8eVT7A.js" as="script"><link rel="prefetch" href="/assets/auth-server-setup.html-CWtU2NHj.js" as="script"><link rel="prefetch" href="/assets/deployment-pipelines.html-BZbxpf-s.js" as="script"><link rel="prefetch" href="/assets/email-provider-setup.html-C3h0gVHu.js" as="script"><link rel="prefetch" href="/assets/embedded-auth-api.html-sD3icr9L.js" as="script"><link rel="prefetch" href="/assets/q_a.html-BsfmsiT_.js" as="script"><link rel="prefetch" href="/assets/react-sdk.html-mi5ahEjP.js" as="script"><link rel="prefetch" href="/assets/s2s-api.html-C8F_6vH1.js" as="script"><link rel="prefetch" href="/assets/saml-sso-setup.html-CdiLJ1rB.js" as="script"><link rel="prefetch" href="/assets/screenshots.html-D7Owu13G.js" as="script"><link rel="prefetch" href="/assets/sms-provider-setup.html-ahMi_DvT.js" as="script"><link rel="prefetch" href="/assets/social-sign-in-provider-setup.html-BUEa9gzE.js" as="script"><link rel="prefetch" href="/assets/vue-sdk.html-DoAnB5tQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CpMXclHj.js" as="script"><link rel="prefetch" href="/assets/admin-panel-setup.html-D9v8XL37.js" as="script"><link rel="prefetch" href="/assets/angular-sdk.html-DMOe7zjb.js" as="script"><link rel="prefetch" href="/assets/auth-server-configuration.html-t-XHIy9S.js" as="script"><link rel="prefetch" href="/assets/auth-server-setup.html-Dh1emQVF.js" as="script"><link rel="prefetch" href="/assets/deployment-pipelines.html-DspX7dEb.js" as="script"><link rel="prefetch" href="/assets/email-provider-setup.html-Dm8_DJWa.js" as="script"><link rel="prefetch" href="/assets/embedded-auth-api.html-Cmit6FZf.js" as="script"><link rel="prefetch" href="/assets/q_a.html-DHyJwCik.js" as="script"><link rel="prefetch" href="/assets/react-sdk.html-COSMmSU0.js" as="script"><link rel="prefetch" href="/assets/s2s-api.html-Cx_iUrAG.js" as="script"><link rel="prefetch" href="/assets/saml-sso-setup.html-JKc79DM7.js" as="script"><link rel="prefetch" href="/assets/screenshots.html-1Qk8w8cW.js" as="script"><link rel="prefetch" href="/assets/sms-provider-setup.html-BDgLSggk.js" as="script"><link rel="prefetch" href="/assets/social-sign-in-provider-setup.html-QKLSLxps.js" as="script"><link rel="prefetch" href="/assets/vue-sdk.html-DyaRnakj.js" as="script"><link rel="prefetch" href="/assets/404.html-CDzsmfvp.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://valuemelody.com/logo.svg" alt="Melody Auth"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Melody Auth</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/admin-panel-setup.html" aria-label="English"><!--[--><!--[--><!--]--><!--]-->English<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/zh/admin-panel-setup.html" aria-label="zh-CN"><!--[--><!--[--><!--]--><!--]-->zh-CN<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/admin-panel-setup.html" aria-label="English"><!--[--><!--[--><!--]--><!--]-->English<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/zh/admin-panel-setup.html" aria-label="zh-CN"><!--[--><!--[--><!--]--><!--]-->zh-CN<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Admin Panel <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="admin-panel" tabindex="-1"><a class="header-anchor" href="#admin-panel"><span>Admin Panel</span></a></h1><p>Follow these instructions to set up and run the admin panel locally or in production.</p><h2 id="_1-prerequisites" tabindex="-1"><a class="header-anchor" href="#_1-prerequisites"><span>1. Prerequisites</span></a></h2><p>Complete the auth server setup first.</p><h2 id="_2-get-started" tabindex="-1"><a class="header-anchor" href="#_2-get-started"><span>2. Get Started</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd melody-auth/admin-panel</span>
<span class="line">cp .env.example .env</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-update-the-env-file-with-the-following-variables" tabindex="-1"><a class="header-anchor" href="#_3-update-the-env-file-with-the-following-variables"><span>3. Update the .env file with the following variables:</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">NEXT_PUBLIC_CLIENT_URI: Set this to the host url of your admin panel app</span>
<span class="line">NEXT_PUBLIC_SERVER_URI: Set this to the host url of your auth server.</span>
<span class="line">NEXT_PUBLIC_CLIENT_ID: Client ID for the &quot;Admin Panel (SPA)&quot; app</span>
<span class="line">SERVER_CLIENT_ID: Client ID for the &quot;Admin Panel (S2S)&quot; app</span>
<span class="line">SERVER_CLIENT_SECRET: Client secret for the &quot;Admin Panel (S2S)&quot; app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>For Cloudflare remote/production environment, you can find the necessary information in the Cloudflare dashboard under &quot;Workers &amp; Pages&quot; -&gt; D1 -&gt; Melody Auth database -&gt; app table.</li><li>For Cloudflare local/development environment, use the following command to retrieve app information:<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd melody-auth/server</span>
<span class="line">wrangler d1 execute melody-auth --command=&quot;select * from app&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li>For NodeJS environment, check your Postgres melody-auth database -&gt; app table</li></ul><h2 id="_4-start-the-admin-panel-app" tabindex="-1"><a class="header-anchor" href="#_4-start-the-admin-panel-app"><span>4. Start the admin panel app</span></a></h2><p>Start the admin panel app</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd melody-auth/admin-panel</span>
<span class="line">npm install</span>
<span class="line">npm run dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="first-time-setup" tabindex="-1"><a class="header-anchor" href="#first-time-setup"><span>First-time Setup</span></a></h3><ol><li>When you first access the admin panel, you&#39;ll be redirected to the auth server login screen. Create a new account.</li><li>After creating an account, you&#39;ll be redirected back to the admin panel with an &quot;super_admin role required&quot; alert. This is expected for new accounts.</li><li>To grant super admin access: <ul><li>For Cloudflare remote/production environment: <ol><li>Go to the Cloudflare dashboard</li><li>Navigate to &quot;Workers &amp; Pages&quot; -&gt; D1 -&gt; Melody Auth database -&gt; user_role table</li><li>Add a new record with userId = 1 and roleId = 1 (assuming you just created the first user)</li></ol></li><li>For Cloudflare local/development environment:<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">cd melody-auth/server</span>
<span class="line">wrangler d1 execute melody-auth --command=&quot;insert into user_role (userId, roleId) values (1, 1)&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li>For NodeJS environment, insert following record to your Postgres melody-auth database:<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">insert into user_role (userId, roleId) values (1, 1)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li>Logout (Required after update user role) and login again. You should now have full access.</li></ol><h3 id="deploy-admin-panel-to-cloudflare-workers" tabindex="-1"><a class="header-anchor" href="#deploy-admin-panel-to-cloudflare-workers"><span>Deploy Admin Panel to Cloudflare Workers</span></a></h3><p>The Admin Panel is a full-stack Next.js application typically deployed in a Node.js environment. Deployment to Cloudflare Workers is now supported via the opennextjs-cloudflare package.</p><p><strong>Note</strong>: Cloudflare Workers cannot call other Workers within the same Cloudflare account, so if you plan to deploy both the Admin Panel and the Auth Server on Cloudflare, you must either assign each Worker a custom domain (e.g., admin.example.com and auth.example.com), or deploy the two Workers under separate Cloudflare accounts to avoid the restriction.</p><p>Steps to Deploy:</p><ol><li><p>Create a new worker named &quot;melody-auth-admin-panel&quot;</p></li><li><p>Go to &quot;melody-auth-admin-panel&quot; Cloudflare Dashboard -&gt; Settings -&gt; Variables and Secrets, add following secrets</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">SERVER_CLIENT_ID=[Client ID for the &quot;Admin Panel (S2S)&quot; app]</span>
<span class="line">SERVER_CLIENT_SECRET=[Client secret for the &quot;Admin Panel (S2S)&quot; app]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>In your project directory, under the /admin-panel folder, create an .env file:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">NEXT_PUBLIC_CLIENT_URI=[The host url of this admin panel worker]</span>
<span class="line">NEXT_PUBLIC_SERVER_URI=[The host url of your auth server]</span>
<span class="line">NEXT_PUBLIC_CLIENT_ID=[Client ID for the &quot;Admin Panel (SPA)&quot; app]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Navigate to &quot;Workers &amp; Pages&quot; -&gt; D1 -&gt; Melody Auth database -&gt; app table</p><ul><li>Update the redirectUris values in &quot;Admin Panel (SPA)&quot; entry with the cloudflare (e.g., https://melody-auth-admin.[your-account-name].workers.dev)</li></ul></li><li><p>Build the project</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">npm run cf:build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Deploy</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">npm run cf:deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h2 id="custom-role-access-for-the-admin-panel" tabindex="-1"><a class="header-anchor" href="#custom-role-access-for-the-admin-panel"><span>Custom Role Access for the Admin Panel</span></a></h2><p>By default, the admin panel only accepts logins from the super_admin role. To enable login using a custom role with limited permissions, follow these steps:</p><ol><li>Add your custom role to the <strong>AllowedRoles</strong> array in /admin-panel/tools/access.</li><li>Define the access permissions for your custom role within <strong>RoleAccesses</strong> in /admin-panel/tools/access.</li></ol></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-06-01T02:26:59.000Z" data-allow-mismatch>6/1/25, 2:26 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: byn9826@gmail.com">Baozier</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: raphael.carrier@gmail.com">Raph</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BVdeq8C2.js" defer></script>
  </body>
</html>
