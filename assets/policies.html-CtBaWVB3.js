import{_ as a,c as n,a as e,o as p}from"./app-BYllXYX5.js";const l={};function o(i,s){return p(),n("div",null,s[0]||(s[0]=[e(`<h1 id="如何触发不同的-policy" tabindex="-1"><a class="header-anchor" href="#如何触发不同的-policy"><span>如何触发不同的 policy</span></a></h1><p>Policies 允许你在不更改应用逻辑的情况下，将用户路由到不同的授权体验（例如，更新信息、更改密码）。</p><h2 id="触发-policy-的方式" tabindex="-1"><a class="header-anchor" href="#触发-policy-的方式"><span>触发 policy 的方式</span></a></h2><ul><li><p>使用 authorize URL（query string）</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">const</span> url <span class="token operator">=</span> serverUri <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;/oauth2/v1/authorize?&#39;</span> <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;response_type=code&#39;</span> <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;state=&#39;</span> <span class="token operator">+</span> state <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;client_id=&#39;</span> <span class="token operator">+</span> clientId <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;redirect_uri=&#39;</span> <span class="token operator">+</span> redirectUri <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;code_challenge=&#39;</span> <span class="token operator">+</span> codeChallenge <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;code_challenge_method=S256&#39;</span> <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;policy=&#39;</span> <span class="token operator">+</span> policy <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;scope=&#39;</span> <span class="token operator">+</span> scope <span class="token operator">+</span></span>
<span class="line">  <span class="token string">&#39;&amp;locale=&#39;</span> <span class="token operator">+</span> locale</span>
<span class="line">window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> url</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用 Frontend SDK</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">const</span> <span class="token punctuation">{</span> loginRedirect <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token function">loginRedirect</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  policy<span class="token operator">:</span> <span class="token string">&#39;change_password&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>注意：所有暴露了 <code>loginRedirect</code> 方法的前端 SDK 都接受一个可选的 <code>policy</code> 参数。如果省略，则会应用默认的 policy。</p><h2 id="支持的-policies" tabindex="-1"><a class="header-anchor" href="#支持的-policies"><span>支持的 policies</span></a></h2><ul><li><code>sign_in_or_sign_up</code>：默认 policy。</li><li><code>update_info</code>：允许用户更新其信息。</li><li><code>change_password</code>：允许用户更改密码（仅限基于密码的用户）。需要 <code>ENABLE_PASSWORD_RESET=true</code>。</li><li><code>change_email</code>：允许用户更改邮箱地址（仅限基于密码的用户）。需要 <code>ENABLE_EMAIL_VERIFICATION=true</code>。</li><li><code>reset_mfa</code>：允许用户重置已注册的 MFA（多因素认证）方法。</li><li><code>manage_passkey</code>：允许用户管理其 passkey。需要 <code>ALLOW_PASSKEY_ENROLLMENT=true</code>。</li><li><code>manage_recovery_code</code>：允许用户管理其恢复代码。</li><li><code>saml_sso_[idp_name]</code>：允许用户通过 SAML SSO 登录。</li><li><code>oidc_sso_[provider_name]</code>：允许用户通过 OIDC SSO 登录。</li></ul><h2 id="注意事项和最佳实践" tabindex="-1"><a class="header-anchor" href="#注意事项和最佳实践"><span>注意事项和最佳实践</span></a></h2><ul><li>如果某个 policy 依赖的功能被禁用，授权请求将无法继续。请先启用所需的功能开关。</li><li>你可以在适用的情况下，将 <code>policy</code> 与其他查询参数（如 <code>org</code> 和 <code>locale</code>）组合使用。</li></ul>`,9)]))}const t=a(l,[["render",o]]),r=JSON.parse('{"path":"/zh/policies.html","title":"如何触发不同的 policy","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1754954867000,"contributors":[{"name":"Baozier","username":"Baozier","email":"byn9826@gmail.com","commits":1,"url":"https://github.com/Baozier"}],"changelog":[{"hash":"8072502fc071765c4d8e2ab6e797919d78d7c086","time":1754954867000,"email":"byn9826@gmail.com","author":"Baozier","message":"Regroup docs (#420)"}]},"filePathRelative":"zh/policies.md"}');export{t as comp,r as data};
