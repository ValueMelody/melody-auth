import{_ as i,c as l,b as n,a as r,e,d as t,w as d,r as o,o as p}from"./app-CbmF9cII.js";const u={};function g(h,a){const s=o("RouteLink");return p(),l("div",null,[a[9]||(a[9]=n("h1",{id:"组织",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#组织"},[n("span",null,"组织")])],-1)),a[10]||(a[10]=n("p",null,"Melody Auth 中的组织功能提供：",-1)),n("ul",null,[a[4]||(a[4]=n("li",null,[n("strong",null,"用户管理"),e("：将用户组织到不同的组织上下文中")],-1)),a[5]||(a[5]=n("li",null,[n("strong",null,"注册控制"),e("：组织可以启用或禁用公开用户注册")],-1)),a[6]||(a[6]=n("li",null,[n("strong",null,"用户关联"),e("：用户可以成为多个组织的成员")],-1)),a[7]||(a[7]=n("li",null,[n("strong",null,"活跃组织"),e("：用户只能在一个活跃组织中")],-1)),n("li",null,[a[1]||(a[1]=n("strong",null,"自定义Branding",-1)),a[2]||(a[2]=e("：每个组织可以向用户展示不同的视觉标识",-1)),a[3]||(a[3]=n("br",null,null,-1)),t(s,{to:"/zh/branding.html#per-organization-branding"},{default:d(()=>a[0]||(a[0]=[e("按组织自定义Branding",-1)])),_:1,__:[0]})]),a[8]||(a[8]=n("li",null,[n("strong",null,"灵活配置"),e("：可控制用户是否加入组织，或仅看到自定义Branding")],-1))]),a[11]||(a[11]=r(`<h2 id="启用组织功能" tabindex="-1"><a class="header-anchor" href="#启用组织功能"><span>启用组织功能</span></a></h2><p>要在 Melody Auth 实例中启用组织功能，请在 <code>server/wrangler.toml</code> 的 <code>[vars]</code> 下设置 <code>ENABLE_ORG = true</code>。</p><h2 id="branding-继承规则" tabindex="-1"><a class="header-anchor" href="#branding-继承规则"><span>Branding 继承规则</span></a></h2><p>品牌系统遵循以下优先级：</p><ol><li><strong>组织特定设置</strong>（最高优先级）</li><li><strong>全局默认设置</strong>（作为回退）</li></ol><p>如果组织未指定某个 Branding 元素，则会继承全局默认值。</p><h2 id="管理面板管理" tabindex="-1"><a class="header-anchor" href="#管理面板管理"><span>管理面板管理</span></a></h2><h3 id="创建组织" tabindex="-1"><a class="header-anchor" href="#创建组织"><span>创建组织</span></a></h3><ol><li>打开管理面板，点击导航中的 “Orgs”</li><li>点击 “Create an org” 按钮</li><li>填写必填字段： <ul><li><strong>Name</strong>：显示名称（例如 “Acme Corporation”）</li><li><strong>Slug</strong>：URL 唯一标识（例如 “acme-corp”）</li><li><strong>Allow Public Registration</strong>：启用/禁用公开用户注册</li><li><strong>Only Use for Branding Override</strong>：用户只会看到自定义 Branding，但不会成为成员</li></ul></li><li>点击 “Save” 创建组织</li></ol><h3 id="管理组织用户" tabindex="-1"><a class="header-anchor" href="#管理组织用户"><span>管理组织用户</span></a></h3><ul><li>在组织详情页面查看组织内的所有用户</li><li>如果用户记录中包含组织的 slug，则会显示在列表中</li><li>如果关闭了公开注册，可手动添加用户</li></ul><h3 id="组织设置" tabindex="-1"><a class="header-anchor" href="#组织设置"><span>组织设置</span></a></h3><ul><li>编辑组织名称、slug 和注册策略</li><li>配置自定义 Branding（Logo、颜色、字体）</li><li>更新法律链接（服务条款、隐私政策）</li></ul><h2 id="api-集成" tabindex="-1"><a class="header-anchor" href="#api-集成"><span>API 集成</span></a></h2><p>可通过 S2S API 以编程方式管理组织。</p><h3 id="组织管理-api" tabindex="-1"><a class="header-anchor" href="#组织管理-api"><span>组织管理 API</span></a></h3><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http"><pre><code class="language-http"><span class="line">GET /api/v1/orgs: 获取所有组织</span>
<span class="line">GET /api/v1/orgs/{id}: 获取指定组织详情</span>
<span class="line">POST /api/v1/orgs: 创建新组织</span>
<span class="line">PUT /api/v1/orgs/{id}: 更新组织设置</span>
<span class="line">DELETE /api/v1/orgs/{id}: 删除组织</span>
<span class="line">GET /api/v1/orgs/{id}/users: 获取组织内所有用户</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="用户组织管理-api" tabindex="-1"><a class="header-anchor" href="#用户组织管理-api"><span>用户组织管理 API</span></a></h3><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http"><pre><code class="language-http"><span class="line">GET /api/v1/users/{authId}/orgs: 获取用户所有组织</span>
<span class="line">POST /api/v1/users/{authId}/orgs: 更新用户组织</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="设置用户活跃组织" tabindex="-1"><a class="header-anchor" href="#设置用户活跃组织"><span>设置用户活跃组织</span></a></h3><div class="language-http line-numbers-mode" data-highlighter="prismjs" data-ext="http"><pre><code class="language-http"><span class="line">PUT /api/v1/users/{authId}: 将orgSlug设置为该用户已加入的组织slug</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="注册流程场景" tabindex="-1"><a class="header-anchor" href="#注册流程场景"><span>注册流程场景</span></a></h2><h3 id="场景-1-开放组织且有用户成员" tabindex="-1"><a class="header-anchor" href="#场景-1-开放组织且有用户成员"><span>场景 1：开放组织且有用户成员</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">allowPublicRegistration: true</span>
<span class="line">onlyUseForBrandingOverride: false</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结果</strong>：用户可以注册并自动成为组织成员。他们会出现在组织的用户列表中，并在组织内进行管理。</p><h3 id="场景-2-仅品牌显示-无用户成员" tabindex="-1"><a class="header-anchor" href="#场景-2-仅品牌显示-无用户成员"><span>场景 2：仅品牌显示（无用户成员）</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">allowPublicRegistration: true</span>
<span class="line">onlyUseForBrandingOverride: true</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结果</strong>：用户在注册时会看到组织 Branding，但不会成为组织成员。他们仍为全局用户。</p><h3 id="场景-3-关闭组织" tabindex="-1"><a class="header-anchor" href="#场景-3-关闭组织"><span>场景 3：关闭组织</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">allowPublicRegistration: false</span>
<span class="line">onlyUseForBrandingOverride: false/true（均可）</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结果</strong>：不允许公开注册。组织管理员必须手动将用户添加到组织中。</p>`,31))])}const m=i(u,[["render",g]]),v=JSON.parse('{"path":"/zh/organizations.html","title":"组织","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1761178376000,"contributors":[{"name":"Baozier","username":"Baozier","email":"byn9826@gmail.com","commits":2,"url":"https://github.com/Baozier"}],"changelog":[{"hash":"668b4b7a3a3a0ce277df29ec239529e92018abe8","time":1761178376000,"email":"byn9826@gmail.com","author":"Baozier","message":"Support set user to multi orgs in admin panel (#441)"},{"hash":"5396c9586a61f59593ebaea2b6848496a7027f19","time":1755304846000,"email":"byn9826@gmail.com","author":"Baozier","message":"Add docs for main features (#428)"}]},"filePathRelative":"zh/organizations.md"}');export{m as comp,v as data};
